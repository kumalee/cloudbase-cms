(this["webpackJsonptcb-service-admin"]=this["webpackJsonptcb-service-admin"]||[]).push([[7],{1113:function(e,a,t){"use strict";t.r(a),t.d(a,"RescourceComponentsFactory",(function(){return ge}));var n=t(83),r=t(723),c=t(0),l=t.n(c),i=t(1118),o=t(1123),u=t(1079),s=t(1110),m=t(1119),d=t(1111),f=t(1078),b=t(1124),p=t(1112),E=t(1117),y=t(1007),k=t(1085),v=t(1086),g=t(1087),h=t(1088),T=t(1089),j=t(1090),N=t(1091),O=t(1092),w=t(1093),x=t(1094),S=t(1095),L=t(1096),C=t(1125),F=t(1120),D=t(1097),A=t(1058),R=t(1098),I=t(1099),P=t(1100),M=t(690),V=t(1126),B=t(1103),U=t(1115),_=t(1105),H=t(1130),$=t(1106),q=t(1107),z=t(1131),J=t(1121),G=t(436),K=t(1128),Q=t(1102),W=t(103),X=t(736),Y=t.n(X),Z=t(1127),ee=t(449),ae=t(440),te=function(e){var a=Object(Z.a)(e).input.onChange,t=Object(c.useState)(e.record[e.source]),n=Object(W.a)(t,2),r=n[0],i=n[1],o=e.pickLabel,u=void 0===o?"\u9009\u62e9\u56fe\u6807":o,s=e.cancelLabel,m=void 0===s?"\u53d6\u6d88":s,d=e.modalTitle,f=void 0===d?"\u56fe\u6807\u9009\u62e9\u5668":d;return l.a.createElement("div",{className:"tcb-cms-icon-input"},l.a.createElement(ae.a,{variant:"caption",paragraph:!0,style:{margin:"20px 0 10px",color:"rgba(0, 0, 0, 0.54)"}},"\u56fe\u6807\u8bbe\u7f6e"),l.a.createElement(Y.a,{label:u,pickLabel:u,cancelLabel:m,modalTitle:f,onPick:function(e){i(e.name),a(e.name)}}),l.a.createElement(ee.a,null,r||"library_books"))},ne=function(e){var a,t=null===(a=e.record)||void 0===a?void 0:a[e.source];return l.a.createElement(ee.a,null,t||"library_books")},re=t(109),ce=t(966),le=t.n(ce),ie=Object(re.a)({link:{textDecoration:"none",display:"block",wordBreak:"break-all"},icon:{width:"0.5em",paddingLeft:2}}),oe=function(e){var a=e.record,t=void 0===a?{}:a,n=e.source,r=ie(),c=t[n];return c?l.a.createElement("a",{href:c,className:r.link,target:"_blank",rel:"noopener noreferrer"},c,l.a.createElement(le.a,{className:r.icon})):null},ue=Object(re.a)({list:{display:"flex",listStyleType:"none"},image:{margin:"0.5rem",maxHeight:"10rem"}},{name:"RaImageField"}),se=function(e){var a,t,n,r=e.className,c=e.emptyText,i=e.record,o=e.source,u=e.title;t="string"===typeof(a=(n="Object",function(e){return Object.prototype.toString.call(e)==="[object "+n+"]"})(i)&&o in i?i[o]:i)?a:a&&a.tempUrl;var s=ue(e);return t?l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,l.a.createElement("small",null,"\u9884\u89c8\u56fe\u7247")),l.a.createElement("img",{className:s.image,src:t,alt:u})):c?l.a.createElement(ae.a,{component:"span",variant:"body2",className:r},c):l.a.createElement("div",{className:r})};var me=function(e){var a,t,n,r=e.className,c=e.emptyText,i=e.record,o=e.source,u=e.title;return(t="string"===typeof(a=(n="Object",function(e){return Object.prototype.toString.call(e)==="[object "+n+"]"})(i)&&o in i?i[o]:i)?a:a&&a.tempUrl)?l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,l.a.createElement("small",null,"\u9884\u89c8\u94fe\u63a5")),l.a.createElement("a",{href:t,title:u,target:"_blank",rel:"noopener noreferrer"},t)):c?l.a.createElement(ae.a,{component:"span",variant:"body2",className:r},c):l.a.createElement("div",{className:r})};var de=t(87),fe=t.n(de),be=new(t(967).Converter)({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0}),pe=function(e){var a=e.className,t=(e.emptyText,e.source),n=e.record,c=void 0===n?{}:n,i=(e.stripTags,Object(r.a)(e,["className","emptyText","source","record","stripTags"]),fe()(c,t));return l.a.createElement(ae.a,{className:a,variant:"body2",component:"span"},l.a.createElement("span",{dangerouslySetInnerHTML:{__html:be.makeHtml(i)}}))},Ee=function(e){var a=e.record,t=e.source;return l.a.createElement(l.a.Fragment,null,a[t]&&Array.isArray(a[t])&&a[t].map((function(e){return l.a.createElement(K.a,{style:{margin:2},label:e,key:e})})))};Ee.defaultProps={addLabel:!0};var ye=Ee,ke=t(1109),ve=t(1114),ge=function(e){var a=e.fields,t=e.label,n=e.description,r=function(e){var a=e.record;return l.a.createElement("span",null,t," / ",a?"#".concat(a.id):"")},c=["String","Number","DateTime","Date","Boolean","Email","Tel","Url","Connect"],k=a.filter((function(e){return c.includes(e.fieldType)})),v=function(e){return l.a.createElement(i.a,e,k.map((function(e){return function(e){var a=e.fieldName,t=e.fieldType,n=e.fieldLabel;if("id"===a)return null;if("Connect"===t)return Oe(e);if("Array"===t)return we(e);var r=je(t,e),c=Ne(t,e);return l.a.createElement(r,{label:n,key:a,source:a,validate:c})}(e)})))},g=function(e){return["RichText","Markdown"].includes(e.fieldType)||e.childFields},h=a.filter(g),T=a.filter((function(e){return!g(e)})).filter((function(e){return!("hidden"in e)||!e.hidden})),j=a.find((function(e){return"String"===e.fieldType})),N=a.find((function(e){return["Date","DateTime"].includes(e.fieldType)})),O=function(e){return l.a.createElement(o.a,Object.assign({},e,{title:" ",className:"tcb-cms-expand"}),l.a.createElement(u.a,null,h.map((function(e){return he(e)}))))};return{ListComponent:function(e){var a=Object(G.a)((function(e){return e.breakpoints.down("sm")}));return l.a.createElement(l.a.Fragment,null,n&&l.a.createElement(ae.a,{variant:"body1",color:"inherit",className:"tcb-cms-desc"},n),l.a.createElement(s.a,Object.assign({filters:l.a.createElement(v,null)},e,{sort:{field:"order",order:"DESC"},title:t}),a?l.a.createElement(m.a,{primaryText:function(e){return e[(null===j||void 0===j?void 0:j.fieldName)||"id"]},secondaryText:function(e){return e[null===N||void 0===N?void 0:N.fieldName]?Object(ke.a)(new Date(e[null===N||void 0===N?void 0:N.fieldName]),"PPpp",{locale:ve.a}):""},tertiaryText:function(){return"..."},linkType:"show"}):l.a.createElement(d.a,h.length?{expand:O}:{},T.map((function(e){return he(e)})),l.a.createElement(f.a,null))))},ShowComponent:l.a.memo((function(e){return l.a.createElement(o.a,Object.assign({},e,{title:l.a.createElement(r,null)}),l.a.createElement(u.a,null,a.map((function(e){return he(e)}))))})),CreateComponent:l.a.memo((function(e){return l.a.createElement(b.a,Object.assign({},e,{title:"".concat(t," / \u65b0\u5efa"),undoable:!1}),l.a.createElement(p.a,{className:"tcb-cms-form"},a.map((function(e){return Te(e)}))))})),EditComponent:l.a.memo((function(e){return l.a.createElement(E.a,Object.assign({title:l.a.createElement(r,null)},e,{undoable:!1}),l.a.createElement(p.a,{className:"tcb-cms-form"},l.a.createElement(y.a,{disabled:!0,source:"id"}),a.map((function(e){return Te(e)}))))}))}};function he(e){var a=e.fieldName,t=e.fieldType,n=e.fieldLabel,r=e.hidden;if(void 0!==r&&r)return k.a;if("Connect"===t)return function(e){var a=e.fieldName,t=e.fieldLabel,n=e.connectResource,r=e.connectField;return e.connectMany?l.a.createElement(H.a,{label:t,source:a,reference:Se(n),key:a},l.a.createElement($.a,{linkType:"show"},l.a.createElement(q.a,{source:r}))):l.a.createElement(z.a,{label:t,source:a,reference:Se(n),allowEmpty:!0,key:a},l.a.createElement(k.a,{source:r}))}(e);if("Array"===t)return function(e){var a=e.fieldName,t=e.fieldLabel,n=e.childFields,r=Array.isArray(n);return n?l.a.createElement(N.a,{source:a,key:a,label:t},r&&l.a.createElement(d.a,null,n.map((function(e){return he(e)})))):l.a.createElement(ye,{source:a,key:a,label:t})}(e);var c=function(e,a){var t;switch(e){case"String":t=k.a;break;case"Markdown":t=pe;break;case"RichText":t=h.a;break;case"Url":t=oe;break;case"Email":t=T.a;break;case"Date":t=j.a;break;case"DateTime":t=function(e){return l.a.createElement(j.a,Object.assign({},e,{showTime:!0}))};break;case"Array":t=N.a;break;case"Boolean":t=O.a;break;case"Image":t=se;break;case"File":t=me;break;case"Number":t=w.a;break;case"Select":t=function(e){return l.a.createElement(x.a,Object.assign({},e,{choices:a.options}))};break;case"SelectArray":t=function(e){var a=e.record,t=e.source;return l.a.createElement(l.a.Fragment,null,a[t].map((function(e){return l.a.createElement(K.a,{style:{margin:2},label:e,key:e})})))};break;case"Password":t=k.a;break;case"Icon":t=ne;break;default:t=k.a}return t}(t,e);return l.a.createElement(c,{label:n,key:a,source:a})}function Te(e){var a=e.fieldName,t=e.fieldType,c=e.fieldLabel,i=e.defaultValue,o=e.helpText,u=e.expectField,s=e.expectValue;if("id"===a)return null;if("Array"===t)return we(e);var m=je(t,e);return l.a.createElement(v.a,{key:a},(function(d){var f=d.formData,b=d.scopedFormData,p=d.getSource,E=Object(r.a)(d,["formData","scopedFormData","getSource"]);function y(e,a,t){return a?a[t]:e[t]}if(u&&y(f,b,u)!==s)return null;if("defaultValue"===a&&(t=y(f,b,"fieldType"),!["String"].includes(t)))return null;if("isRequired"===a&&(t=y(f,b,"fieldType"),["Connect"].includes(t)))return null;if("connectField"===a){var k=y(f,b,"connectResource");if(k){var v=function(e){var a=Se(e);return window.cmsConfig.resouceIndexByCollectionName[a].fields.filter((function(e){return"Connect"!==e.fieldType})).map((function(e){return{id:e.fieldName,name:e.fieldLabel}}))}(k);return l.a.createElement(g.a,Object.assign({},E,{label:c,key:a,source:p?p(a):a,initialValue:i,helperText:o,choices:v}))}}if("Connect"===t)return Oe(Object(n.a)({},e,{fieldName:p?p(a):a}));var h=Ne(t,e);return l.a.createElement(m,Object.assign({},E,{label:c,key:a,source:p?p(a):a,validate:h,initialValue:i,helperText:o}))}))}function je(e,a){var n;switch(e){case"String":n=y.a;break;case"Email":n=function(e){return l.a.createElement(y.a,Object.assign({},e,{type:"email"}))};break;case"Url":n=function(e){return l.a.createElement(y.a,Object.assign({},e,{type:"url"}))};break;case"RichText":n=xe(l.a.lazy((function(){return t.e(4).then(t.bind(null,1122))})));break;case"Markdown":n=xe(l.a.lazy((function(){return Promise.all([t.e(5),t.e(6)]).then(t.bind(null,1108))})));break;case"Date":n=S.a;break;case"DateTime":n=L.a;break;case"Array":n=C.a;break;case"Boolean":n=F.a;break;case"Image":n=function(e){return l.a.createElement(D.a,Object.assign({},e,{accept:"image/*"}),l.a.createElement(se,{source:e.source}))};break;case"File":n=function(e){return l.a.createElement(A.a,e,l.a.createElement(me,{source:e.source,title:"title"}))};break;case"Number":n=R.a;break;case"Select":n=function(e){return l.a.createElement(g.a,Object.assign({},e,{choices:a.options}))};break;case"SelectArray":n=function(e){return l.a.createElement(I.a,Object.assign({},e,{choices:a.options}))};break;case"Password":n=P.a;break;case"Icon":n=te;break;default:n=y.a}return n}function Ne(e,a){var t=a.isRequired,n=a.stringMaxLength,r=a.stringMinLength,c=[];switch(t&&c.push(Object(M.g)()),e){case"String":r&&c.push(Object(M.d)(r)),n&&c.push(Object(M.c)(n));break;case"Url":c.push(Object(M.f)(/^https?:\/\/[^\s$.?#].[^\s]*$/,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f51\u5740"));break;case"Email":c.push(Object(M.b)());break;case"Number":c.push(Object(M.e)());break;case"Tel":c.push(Object(M.f)(/^((\d{11})|(\d{7,8})|(\d{4}|\d{3})-(\d{7,8}))$/,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801"))}return c}function Oe(e){var a=e.fieldName,t=e.fieldLabel,n=e.connectResource,r=e.connectField;return e.connectMany?l.a.createElement(V.a,{label:t,source:a,reference:Se(n),key:a,perPage:1e3},l.a.createElement(B.a,{optionText:r,allowEmpty:!0})):l.a.createElement(U.a,{label:t,source:a,reference:Se(n),key:a,perPage:1e3,allowEmpty:!0},l.a.createElement(_.a,{optionText:r,allowEmpty:!0}))}function we(e){var a=e.fieldName,t=e.fieldLabel,n=e.childFields,r=e.defaultValue,c=Array.isArray(n);return l.a.createElement(C.a,{source:a,key:a,label:t,initialValue:r},l.a.createElement(J.a,{className:"tcb-cms-array-input"},c?n.map((function(e){return Te(e)})):l.a.createElement(y.a,{label:t})))}function xe(e){return function(a){return l.a.createElement(c.Suspense,{fallback:l.a.createElement(Q.a,null)},l.a.createElement(e,a))}}function Se(e){var a;return(null===(a=window.cmsConfig.resouceIndexById[e])||void 0===a?void 0:a.collectionName)||e}}}]);
//# sourceMappingURL=7.7ef00981.chunk.js.map